---
title: "Second Week Activities"
author: "OscarAMtz"
date: "28 de enero de 2019"
output: html_document
---
## Second Week
##
## directory used: "c:/Users/OscarAMtz/Desktop/specdata"
### First Assingment
```{r}
dir <- "c:/Users/OscarAMtz/Desktop/specdata"

pollutantmean <- function(directory, pollutant, id = 1:332){
  files <- list.files(directory, full.names = TRUE)
  pt <- lapply(files[id], read.csv)
  mpt <- do.call(rbind, pt)
  mean(mpt[,pollutant == names(mpt)], na.rm = TRUE)
}

pollutantmean(dir, "sulfate", id = 1:10)
pollutantmean(dir, "nitrate", 70:72)
pollutantmean(dir, "nitrate", 23)
```

### Second assigment

```{r}
dir <- "c:/Users/OscarAMtz/Desktop/specdata"
complete <- function(directory, id = 1:332){
  files <- list.files(directory, full.names = TRUE)
  pt <- lapply(files[id], read.csv)
  mpt <- do.call(rbind, pt)
  output <- data.frame()
  for (i in id){
    idmpt <- mpt[mpt$ID == i,]
    compt <- complete.cases(idmpt)
    rows <- sum(compt)
    output <- rbind(output, c(i, rows))
  }
  colnames(output)  <- c("id","nobs")
  output
}
complete(dir, c(2, 4, 8, 10, 12))
complete(dir, 30:25)
complete(dir, 3)

##SoluciÃ³n alternativa

```


### Third assignment 

```{r}
dir <- "c:/Users/OscarAMtz/Desktop/specdata"
corr <- function(directory, threshold = 0){
  ## Getting list names
  ccases <- complete(directory)
  mtthres <- ccases[ccases$nobs > threshold,"id"]
  ## Reading data
  files <- list.files(directory, full.names = TRUE)
  pt <- lapply(files, read.csv)
  mpt <- do.call(rbind, pt)
  ## Complete cases
  mpt_cc <- mpt[complete.cases(mpt),]
  correlation <- vector()
      for (i in mtthres){
          mptcc_fcor <- cor(mpt_cc[mpt_cc$ID == i,2], mpt_cc[mpt_cc$ID == i,3])
          correlation <- c(correlation, mptcc_fcor)
        }
  correlation
}

cr <- corr(dir, threshold = 150)
head(cr)
summary(cr)
length(cr)
cr <- corr(dir, threshold = 400)
head(cr)
summary(cr)
length(cr)
cr <- corr(dir, threshold = 5000)
head(cr)
summary(cr)
length(cr)
cr <- corr(dir, 0)
head(cr)
summary(cr)
length(cr)
```
